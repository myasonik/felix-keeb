/*
 * FelixKeeb + Prospector Dongle keymap
 * Based on layout from: https://docs.google.com/spreadsheets/d/1UymUOe9Zpj555tNwIY8a-8gZLkUYepfPnqweN8LK8dA
 *
 * Matrix layout (64 keys total — helix-compatible):
 *   Rows 0-2: 12 keys per row (6 left + 6 right, center extra columns absent)
 *   Rows 3-4: 14 keys per row (7 left + 7 right, includes inner centre keys)
 *
 * Reading order in bindings matches the helix matrix transform:
 *   Row 0: RC(0,0-5) then RC(0,8-13)
 *   Row 1: RC(1,0-5) then RC(1,8-13)
 *   Row 2: RC(2,0-5) then RC(2,8-13)
 *   Row 3: RC(3,0-6) then RC(3,7-13)
 *   Row 4: RC(4,0-6) then RC(4,7-13)
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/ext_power.h>

/ {
    keymap {
        compatible = "zmk,keymap";

        // ─────────────────────────────────────────────────────────────────
        // Layer 0 – BASE
        // ┌──────┬───┬───┬───┬───┬───┐               ┌───┬───┬───┬───┬───┬─────┐
        // │  `~  │ 1 │ 2 │ 3 │ 4 │ 5 │               │ 6 │ 7 │ 8 │ 9 │ 0 │  -  │
        // ├──────┼───┼───┼───┼───┼───┤               ├───┼───┼───┼───┼───┼─────┤
        // │ TAB  │ Q │ W │ E │ R │ T │               │ Y │ U │ I │ O │ P │  =  │
        // ├──────┼───┼───┼───┼───┼───┤               ├───┼───┼───┼───┼───┼─────┤
        // │ BSPC │ A │ S │ D │ F │ G │               │ H │ J │ K │ L │ ; │  '  │
        // ├──────┼───┼───┼───┼───┼───┼─────┐   ┌────┼───┼───┼───┼───┼───┼─────┤
        // │ SHFT │ Z │ X │ C │ V │ B │ ESC │   │ \  │ N │ M │ , │ . │ ↑ │SHFT │
        // ├──────┼───┼───┼───┼───┼───┼─────┤   ├────┼───┼───┼───┼───┼───┼─────┤
        // │ CTRL │GUI│ALT│MO1│   │SPC│ ENT │   │ /  │SPC│ [ │ ] │ ← │ ↓ │  →  │
        // └──────┴───┴───┴───┴───┴───┴─────┘   └────┴───┴───┴───┴───┴───┴─────┘
        // ─────────────────────────────────────────────────────────────────
        default_layer {
            display-name = "BASE";
            bindings = <
// Row 0 (12 keys) ─────────────────────────────────────────────────────────────
&kp GRAVE  &kp N1    &kp N2    &kp N3    &kp N4    &kp N5    &kp N6    &kp N7    &kp N8    &kp N9    &kp N0    &kp MINUS
// Row 1 (12 keys) ─────────────────────────────────────────────────────────────
&kp TAB    &kp Q     &kp W     &kp E     &kp R     &kp T     &kp Y     &kp U     &kp I     &kp O     &kp P     &kp EQUAL
// Row 2 (12 keys) ─────────────────────────────────────────────────────────────
&kp BSPC   &kp A     &kp S     &kp D     &kp F     &kp G     &kp H     &kp J     &kp K     &kp L     &kp SEMI  &kp SQT
// Row 3 (14 keys — includes inner centre keys ESC and \) ──────────────────────
&kp LSHFT  &kp Z     &kp X     &kp C     &kp V     &kp B     &kp ESC   &kp BSLH  &kp N     &kp M     &kp COMMA &kp DOT   &kp UP    &kp RSHFT
// Row 4 (14 keys — includes inner centre keys ENT and /) ──────────────────────
&kp LCTRL  &kp LGUI  &kp LALT  &mo 1     &none     &kp SPACE &kp RET   &kp FSLH  &kp SPACE &kp LBKT  &kp RBKT  &kp LEFT  &kp DOWN  &kp RIGHT
            >;
        };

        // ─────────────────────────────────────────────────────────────────
        // Layer 1 – 2ND  (active only while MO1 key is held — "temp 2nd layer")
        // &mo 1 is a ZMK *momentary* layer — it is NOT a hardware Fn key.
        // The layer activates exactly while the key is held and drops away on release.
        // Unspecified keys fall through to BASE via &trans.
        // ┌──────┬───┬───┬───┬───┬───┐               ┌─────┬──────┬──────┬──────┬─────┬─────┐
        // │      │   │   │   │   │   │               │     │      │      │      │     │     │
        // ├──────┼───┼───┼───┼───┼───┤               ├─────┼──────┼──────┼──────┼─────┼─────┤
        // │      │   │   │   │   │   │               │     │      │      │      │     │     │
        // ├──────┼───┼───┼───┼───┼───┤               ├─────┼──────┼──────┼──────┼─────┼─────┤
        // │      │   │   │   │   │   │               │     │      │      │      │     │     │
        // ├──────┼───┼───┼───┼───┼───┼─────┐   ┌────┼─────┼──────┼──────┼──────┼─────┼─────┤
        // │      │   │   │   │   │   │     │   │    │     │      │      │      │PGUP │     │
        // ├──────┼───┼───┼───┼───┼───┼─────┤   ├────┼─────┼──────┼──────┼──────┼─────┼─────┤
        // │      │   │   │MO1│   │   │     │   │    │MUTE │VOLDN │VOLUP │ HOME │PGDN │ END │
        // └──────┴───┴───┴───┴───┴───┴─────┘   └────┴─────┴──────┴──────┴──────┴─────┴─────┘
        // ─────────────────────────────────────────────────────────────────
        fn_layer {
            display-name = "2ND";
            bindings = <
// Row 0 (12 keys)
&trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans
// Row 1 (12 keys)
&trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans
// Row 2 (12 keys)
&trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans
// Row 3 (14 keys)  — ↑ becomes Page Up
&trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &kp PG_UP  &trans
// Row 4 (14 keys)  — right-side cluster: space→mute, [→vol↓, ]→vol↑, ←→home, ↓→pgdn, →→end
// MO1 key (&trans here) keeps the layer active while held — it falls through to &mo 1 on BASE
&trans  &trans  &trans  &trans  &trans  &trans  &trans  &trans  &kp C_MUTE  &kp C_VOL_DN  &kp C_VOL_UP  &kp HOME  &kp PG_DN  &kp END
            >;
        };
    };
};
